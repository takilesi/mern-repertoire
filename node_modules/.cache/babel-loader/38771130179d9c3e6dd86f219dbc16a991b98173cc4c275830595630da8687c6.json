{"ast":null,"code":"import _regeneratorRuntime from\"/Users/douglasdeckert/PerScholas/93_RTT/mod-three/mern-rep/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"/Users/douglasdeckert/PerScholas/93_RTT/mod-three/mern-rep/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";// Import all named exports attached to a usersAPI object\n// This syntax can be helpful documenting where the methods come from\nimport*as usersAPI from'./users-api';export function signUp(_x){return _signUp.apply(this,arguments);}function _signUp(){_signUp=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(userData){var token;return _regeneratorRuntime().wrap(function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:_context.next=2;return usersAPI.signUp(userData);case 2:token=_context.sent;//PErsist the \"token\"\nlocalStorage.setItem('token',token);// Baby step by returning whatever is sent back by the server\nreturn _context.abrupt(\"return\",getUser());case 5:case\"end\":return _context.stop();}},_callee);}));return _signUp.apply(this,arguments);}export function getToken(){// getItem returns null if there's no string\nvar token=localStorage.getItem('token');if(!token)return null;// Obtain the payload of the token\nvar payload=JSON.parse(atob(token.split('.')[1]));// A JWT's exp is expressed in seconds, not milliseconds, so convert\nif(payload.exp<Date.now()/1000){// Token has expired - remove it from localStorage\nlocalStorage.removeItem('token');return null;}return token;}export function getUser(){var token=getToken();// If there's a token, return the user in the payload, otherwise return null\nreturn token?JSON.parse(atob(token.split('.')[1])).user:null;}export function logOut(){return _logOut.apply(this,arguments);}function _logOut(){_logOut=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee2(){return _regeneratorRuntime().wrap(function _callee2$(_context2){while(1)switch(_context2.prev=_context2.next){case 0:localStorage.removeItem('token');case 1:case\"end\":return _context2.stop();}},_callee2);}));return _logOut.apply(this,arguments);}export function login(_x2){return _login.apply(this,arguments);}function _login(){_login=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee3(credentials){var token;return _regeneratorRuntime().wrap(function _callee3$(_context3){while(1)switch(_context3.prev=_context3.next){case 0:_context3.next=2;return usersAPI.login(credentials);case 2:token=_context3.sent;localStorage.setItem('token',token);return _context3.abrupt(\"return\",getUser());case 5:case\"end\":return _context3.stop();}},_callee3);}));return _login.apply(this,arguments);}export function checkToken(){return _checkToken.apply(this,arguments);}//const token = await usersAPI.signUp(userData);\nfunction _checkToken(){_checkToken=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee4(){return _regeneratorRuntime().wrap(function _callee4$(_context4){while(1)switch(_context4.prev=_context4.next){case 0:return _context4.abrupt(\"return\",usersAPI.checkToken().then(function(dateStr){return new Date(dateStr);}));case 1:case\"end\":return _context4.stop();}},_callee4);}));return _checkToken.apply(this,arguments);}","map":{"version":3,"names":["usersAPI","signUp","_x","_signUp","apply","arguments","_asyncToGenerator","_regeneratorRuntime","mark","_callee","userData","token","wrap","_callee$","_context","prev","next","sent","localStorage","setItem","abrupt","getUser","stop","getToken","getItem","payload","JSON","parse","atob","split","exp","Date","now","removeItem","user","logOut","_logOut","_callee2","_callee2$","_context2","login","_x2","_login","_callee3","credentials","_callee3$","_context3","checkToken","_checkToken","_callee4","_callee4$","_context4","then","dateStr"],"sources":["/Users/douglasdeckert/PerScholas/93_RTT/mod-three/mern-rep/src/utilities/users-service.js"],"sourcesContent":["// Import all named exports attached to a usersAPI object\n// This syntax can be helpful documenting where the methods come from\nimport * as usersAPI from './users-api';\n\nexport async function signUp(userData) {\n  // Delegate the network request code to the users-api.js API module\n  // which will ultimately return a JSON Web Token (JWT)\n  const token = await usersAPI.signUp(userData);\n\n  //PErsist the \"token\"\n  localStorage.setItem('token', token);\n\n  // Baby step by returning whatever is sent back by the server\n  return getUser();\n}\n\nexport function getToken() {\n  // getItem returns null if there's no string\n  const token = localStorage.getItem('token');\n  if (!token) return null;\n  // Obtain the payload of the token\n  const payload = JSON.parse(atob(token.split('.')[1]));\n  // A JWT's exp is expressed in seconds, not milliseconds, so convert\n  if (payload.exp < Date.now() / 1000) {\n    // Token has expired - remove it from localStorage\n    localStorage.removeItem('token');\n    return null;\n  }\n  return token;\n}\n\nexport function getUser() {\n  const token = getToken();\n  // If there's a token, return the user in the payload, otherwise return null\n  return token ? JSON.parse(atob(token.split('.')[1])).user : null;\n}\n\n\nexport async function logOut() {\n  localStorage.removeItem('token');\n}\n\nexport async function login(credentials) {\n  const token = await usersAPI.login(credentials);\n\n  localStorage.setItem('token', token);\n\n  return getUser();\n}\n\nexport async function checkToken() {\n  return usersAPI.checkToken()\n  .then((dateStr) => new Date(dateStr))\n}\n//const token = await usersAPI.signUp(userData);"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}